<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sidebar Toggle Fix Test</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Fixed Header Spacer -->
    <div class="header-spacer"></div>
    
    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <div class="flex flex-between">
                <div class="site-logo">
                    <i class="fas fa-shield-alt site-logo-icon"></i>
                    <span>Sidebar Toggle Fix Test</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" style="margin-top: 2rem;">
        <div class="card">
            <div class="card-body">
                <h1>‚úÖ Sidebar Toggle Button Fix Test</h1>
                <p style="font-size: 1.2rem;">
                    <strong>What was fixed:</strong>
                </p>
                <ul style="font-size: 1.1rem; line-height: 1.8;">
                    <li>Toggle button was being <strong>clipped by <code>overflow-x: hidden</code></strong> on body</li>
                    <li>Changed toggle from <code>position: absolute</code> to <code>position: fixed</code></li>
                    <li>Toggle now escapes parent overflow context and is always visible</li>
                    <li>Positioned at <code>right: 280px</code> (width of sidebar) from viewport edge</li>
                    <li>Moves to <code>right: 0</code> when sidebar is collapsed</li>
                </ul>
                
                <h2>üîç What to Look For:</h2>
                <ul style="font-size: 1.1rem; line-height: 1.8;">
                    <li><strong>Gold chevron button</strong> should be visible on the right side of your screen</li>
                    <li>Button should be <strong>280px from the right edge</strong> (sticking into the content area)</li>
                    <li>Clicking it should <strong>collapse/expand the sidebar</strong> smoothly</li>
                    <li>When collapsed, button moves to <strong>viewport right edge</strong></li>
                    <li>Icon should flip: <strong>chevron-right</strong> (open) ‚Üî <strong>chevron-left</strong> (closed)</li>
                </ul>
                
                <div style="background: #e6f3ff; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                    <h3>üìä Live Status:</h3>
                    <p>Viewport Width: <strong id="viewportWidth">...</strong></p>
                    <p>Sidebar State: <strong id="sidebarState">...</strong></p>
                    <p>Toggle Position (right): <strong id="togglePosition">...</strong></p>
                    <p>Toggle Visible: <strong id="toggleVisible">...</strong></p>
                </div>
                
                <button onclick="testToggle()" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: #0066cc; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem;">
                    üß™ Test Toggle Manually
                </button>
            </div>
        </div>
    </main>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-chevron-right"></i>
        </button>
        
        <div class="runegold-display">
            <div style="font-size: 0.875rem; margin-bottom: 0.25rem;">Your Runegold</div>
            <div class="runegold-amount">0</div>
        </div>
        
        <h6 style="margin-bottom: 1rem;">
            <i class="fas fa-users"></i> Online Users
            <span id="onlineCount" style="font-size: 0.75rem; opacity: 0.7;">(0)</span>
        </h6>
        
        <ul class="online-users-list">
            <li class="text-center text-muted" style="padding: 2rem 0;">
                <i class="fas fa-user-slash" style="font-size: 2rem; opacity: 0.3;"></i>
                <p style="margin-top: 1rem; font-size: 0.875rem;">No users online</p>
            </li>
        </ul>
    </aside>

    <script>
        function updateStatus() {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('sidebarToggle');
            
            if (!sidebar || !toggle) return;
            
            const toggleRect = toggle.getBoundingClientRect();
            const toggleStyles = window.getComputedStyle(toggle);
            const isCollapsed = sidebar.classList.contains('collapsed');
            
            document.getElementById('viewportWidth').textContent = window.innerWidth + 'px';
            document.getElementById('sidebarState').textContent = isCollapsed ? 'COLLAPSED' : 'EXPANDED';
            document.getElementById('togglePosition').textContent = toggleStyles.right;
            
            const isVisible = toggleRect.right > 0 && 
                             toggleRect.left < window.innerWidth && 
                             toggleRect.width > 0 && 
                             toggleRect.height > 0 &&
                             toggleStyles.display !== 'none' &&
                             toggleStyles.visibility !== 'hidden' &&
                             parseFloat(toggleStyles.opacity) > 0;
            
            document.getElementById('toggleVisible').textContent = isVisible ? '‚úÖ YES' : '‚ùå NO';
            document.getElementById('toggleVisible').style.color = isVisible ? '#00cc00' : '#cc0000';
        }
        
        function testToggle() {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('sidebarToggle');
            
            if (!sidebar || !toggle) {
                alert('‚ùå Elements not found!');
                return;
            }
            
            toggle.click();
            
            setTimeout(() => {
                const isCollapsed = sidebar.classList.contains('collapsed');
                alert(`‚úÖ Toggle clicked!\n\nNew state: ${isCollapsed ? 'COLLAPSED' : 'EXPANDED'}`);
            }, 100);
        }
        
        // Add toggle functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        
        if (sidebarToggle && sidebar) {
            sidebarToggle.addEventListener('click', () => {
                const isCollapsed = sidebar.classList.toggle('collapsed');
                document.body.classList.toggle('sidebar-collapsed', isCollapsed);
                
                const icon = sidebarToggle.querySelector('i');
                if (icon) {
                    icon.className = isCollapsed 
                        ? 'fas fa-chevron-left' 
                        : 'fas fa-chevron-right';
                }
                
                localStorage.setItem('sidebarCollapsed', isCollapsed);
                
                setTimeout(updateStatus, 350); // Update after transition
            });
            
            // Restore saved state
            const savedState = localStorage.getItem('sidebarCollapsed');
            if (savedState === 'true') {
                sidebar.classList.add('collapsed');
                document.body.classList.add('sidebar-collapsed');
                const icon = sidebarToggle.querySelector('i');
                if (icon) {
                    icon.className = 'fas fa-chevron-left';
                }
            }
        }
        
        // Update status on load and resize
        updateStatus();
        window.addEventListener('resize', updateStatus);
        setInterval(updateStatus, 1000);
    </script>
</body>
</html>
