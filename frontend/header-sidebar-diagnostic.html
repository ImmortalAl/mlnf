<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Header & Sidebar Diagnostic</title>
    <link rel="stylesheet" href="styles.css?v=diagnostic">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Diagnostic overlay */
        .diagnostic-overlay {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 14px;
            z-index: 9999;
            max-width: 450px;
            border: 2px solid lime;
        }

        .diagnostic-overlay h3 {
            color: lime;
            margin-top: 0;
        }

        .measurement {
            margin: 8px 0;
            padding: 5px;
            background: rgba(255,255,255,0.1);
            border-left: 3px solid yellow;
        }

        .value {
            color: cyan;
            font-weight: bold;
        }

        .warning {
            color: orange;
            font-weight: bold;
        }

        .error {
            color: red;
            font-weight: bold;
        }

        .success {
            color: lime;
            font-weight: bold;
        }

        /* Visual guides */
        .header-guide {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            border-bottom: 3px dashed red;
            pointer-events: none;
            z-index: 10000;
        }

        .sidebar-guide {
            position: fixed;
            right: 0;
            width: 280px;
            border: 3px dashed lime;
            pointer-events: none;
            z-index: 10000;
        }

        .spacer-guide {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            border: 3px dashed orange;
            pointer-events: none;
            z-index: 9998;
        }

        /* Debug visibility */
        .site-header {
            background: rgba(255, 0, 0, 0.2) !important;
        }

        .header-spacer {
            background: rgba(255, 165, 0, 0.3) !important;
        }

        .sidebar {
            background: rgba(0, 255, 0, 0.1) !important;
        }

        .sidebar-toggle {
            background: yellow !important;
            color: black !important;
            font-weight: bold !important;
        }
    </style>
</head>
<body>
    <!-- Fixed Header Spacer (from index.html) -->
    <div class="header-spacer"></div>
    <div class="spacer-guide" id="spacerGuide"></div>

    <!-- Header (from index.html) -->
    <header class="site-header">
        <div class="container">
            <div class="flex flex-between">
                <div class="site-logo">
                    <i class="fas fa-shield-alt site-logo-icon"></i>
                    <span>Much Love, No Fear</span>
                </div>

                <nav class="site-nav" id="mainNav">
                    <a href="#" class="nav-link active">Home</a>
                    <a href="#" class="nav-link">Love Vault</a>
                    <a href="#" class="nav-link">Blog</a>
                    <a href="#" class="nav-link">News</a>
                    <a href="#" class="nav-link">Board</a>
                    <a href="#" class="nav-link">Support</a>
                </nav>

                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>
    <div class="header-guide" id="headerGuide"></div>

    <!-- Main Content -->
    <div class="container" style="padding-top: 20px;">
        <h1>Header & Sidebar Diagnostic Test</h1>
        <p>This page shows the exact measurements and positions of the header and sidebar elements.</p>

        <div style="height: 2000px; background: linear-gradient(to bottom, #f0f0f0, #333);">
            <p>Scroll content to test sticky header behavior...</p>
        </div>
    </div>

    <!-- Sidebar (from index.html) -->
    <aside class="sidebar" id="sidebar">
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-chevron-right"></i>
        </button>

        <div class="runegold-display" id="runegoldDisplay">
            <div style="font-size: 0.875rem; margin-bottom: 0.25rem;">Your Runegold</div>
            <div class="runegold-amount">0</div>
            <a href="#" class="btn btn-sm btn-primary" style="margin-top: 0.5rem; width: 100%;">
                <i class="fas fa-shopping-cart"></i> Shop
            </a>
        </div>

        <h6 style="margin-bottom: 1rem;">
            <i class="fas fa-users"></i> Online Users
            <span style="font-size: 0.75rem; opacity: 0.7;">(0)</span>
        </h6>

        <ul class="online-users-list">
            <li>Test User</li>
        </ul>
    </aside>
    <div class="sidebar-guide" id="sidebarGuide"></div>

    <!-- Diagnostic Overlay -->
    <div class="diagnostic-overlay">
        <h3>üìä LAYOUT DIAGNOSTICS</h3>

        <div class="measurement">
            <strong>Header Spacer:</strong>
            <div>Height: <span class="value" id="spacerHeight">--</span></div>
            <div>CSS height: <span class="value" id="spacerCSSHeight">--</span></div>
        </div>

        <div class="measurement">
            <strong>Header:</strong>
            <div>Actual Height: <span class="value" id="headerHeight">--</span></div>
            <div>Offset Top: <span class="value" id="headerTop">--</span></div>
            <div>Bottom Position: <span class="value" id="headerBottom">--</span></div>
            <div>Z-Index: <span class="value" id="headerZIndex">--</span></div>
        </div>

        <div class="measurement">
            <strong>Sidebar:</strong>
            <div>Top Position: <span class="value" id="sidebarTop">--</span></div>
            <div>CSS top: <span class="value" id="sidebarCSSTop">--</span></div>
            <div>Actual Top: <span class="value" id="sidebarActualTop">--</span></div>
            <div>Height: <span class="value" id="sidebarHeight">--</span></div>
            <div>Z-Index: <span class="value" id="sidebarZIndex">--</span></div>
        </div>

        <div class="measurement">
            <strong>Toggle Button:</strong>
            <div>Position: <span class="value" id="togglePosition">--</span></div>
            <div>Top: <span class="value" id="toggleTop">--</span></div>
            <div>Right: <span class="value" id="toggleRight">--</span></div>
            <div>Parent: <span class="value" id="toggleParent">--</span></div>
            <div>Z-Index: <span class="value" id="toggleZIndex">--</span></div>
        </div>

        <div class="measurement">
            <strong>‚ö†Ô∏è Issues:</strong>
            <div id="issues"></div>
        </div>
    </div>

    <script>
        window.addEventListener('load', function() {
            // Get elements
            const spacer = document.querySelector('.header-spacer');
            const header = document.querySelector('.site-header');
            const sidebar = document.querySelector('.sidebar');
            const toggle = document.querySelector('.sidebar-toggle');

            // Measure spacer
            if (spacer) {
                const spacerRect = spacer.getBoundingClientRect();
                const spacerStyles = window.getComputedStyle(spacer);
                document.getElementById('spacerHeight').textContent = spacerRect.height + 'px';
                document.getElementById('spacerCSSHeight').textContent = spacerStyles.height;

                // Position spacer guide
                document.getElementById('spacerGuide').style.height = spacerRect.height + 'px';
            }

            // Measure header
            if (header) {
                const headerRect = header.getBoundingClientRect();
                const headerStyles = window.getComputedStyle(header);
                document.getElementById('headerHeight').textContent = headerRect.height + 'px';
                document.getElementById('headerTop').textContent = headerRect.top + 'px';
                document.getElementById('headerBottom').textContent = headerRect.bottom + 'px';
                document.getElementById('headerZIndex').textContent = headerStyles.zIndex;

                // Position header guide
                document.getElementById('headerGuide').style.top = headerRect.bottom + 'px';
            }

            // Measure sidebar
            if (sidebar) {
                const sidebarRect = sidebar.getBoundingClientRect();
                const sidebarStyles = window.getComputedStyle(sidebar);
                document.getElementById('sidebarTop').textContent = sidebarRect.top + 'px';
                document.getElementById('sidebarCSSTop').textContent = sidebarStyles.top;
                document.getElementById('sidebarActualTop').textContent = sidebarRect.top + 'px';
                document.getElementById('sidebarHeight').textContent = sidebarRect.height + 'px';
                document.getElementById('sidebarZIndex').textContent = sidebarStyles.zIndex;

                // Position sidebar guide
                const sidebarGuide = document.getElementById('sidebarGuide');
                sidebarGuide.style.top = sidebarRect.top + 'px';
                sidebarGuide.style.height = sidebarRect.height + 'px';
            }

            // Measure toggle
            if (toggle) {
                const toggleRect = toggle.getBoundingClientRect();
                const toggleStyles = window.getComputedStyle(toggle);
                document.getElementById('togglePosition').textContent = toggleStyles.position;
                document.getElementById('toggleTop').textContent = toggleRect.top + 'px';
                document.getElementById('toggleRight').textContent = (window.innerWidth - toggleRect.right) + 'px';
                document.getElementById('toggleParent').textContent = toggle.parentElement.tagName + '.' + toggle.parentElement.className;
                document.getElementById('toggleZIndex').textContent = toggleStyles.zIndex;
            }

            // Analyze issues
            const issues = [];

            if (spacer && header) {
                const spacerHeight = spacer.getBoundingClientRect().height;
                const headerHeight = header.getBoundingClientRect().height;
                if (Math.abs(spacerHeight - headerHeight) > 2) {
                    issues.push(`<span class="error">Spacer height (${spacerHeight}px) doesn't match header height (${headerHeight}px)</span>`);
                }
            }

            if (header && sidebar) {
                const headerBottom = header.getBoundingClientRect().bottom;
                const sidebarTop = sidebar.getBoundingClientRect().top;
                const gap = sidebarTop - headerBottom;

                if (Math.abs(gap) > 2) {
                    if (gap > 0) {
                        issues.push(`<span class="warning">Gap of ${gap.toFixed(1)}px between header and sidebar</span>`);
                    } else {
                        issues.push(`<span class="error">Sidebar overlaps header by ${Math.abs(gap).toFixed(1)}px</span>`);
                    }
                } else {
                    issues.push(`<span class="success">‚úì Sidebar properly aligned with header bottom</span>`);
                }
            }

            if (toggle) {
                const toggleParent = toggle.parentElement;
                if (toggleParent === sidebar) {
                    issues.push(`<span class="warning">Toggle is inside sidebar (will move with sidebar)</span>`);
                }

                const toggleRect = toggle.getBoundingClientRect();
                if (toggleRect.width === 0 || toggleRect.height === 0) {
                    issues.push(`<span class="error">Toggle button is invisible (0 dimensions)</span>`);
                }
            }

            document.getElementById('issues').innerHTML = issues.length > 0
                ? issues.join('<br>')
                : '<span class="success">‚úì No issues detected</span>';
        });

        // Toggle functionality
        const toggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');

        toggle.addEventListener('click', function() {
            sidebar.classList.toggle('collapsed');
            const icon = toggle.querySelector('i');
            if (sidebar.classList.contains('collapsed')) {
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
            } else {
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
            }
        });
    </script>
</body>
</html>